<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.or.ddit.prod.dao.IProdDAO">

	<resultMap type="ProdVO" id="prodMap" autoMapping="true">
		<id property="prod_id" column="PROD_ID" />
		<association property="buyer" javaType="BuyerVO"
			autoMapping="true">
			<id property="buyer_id" column="BUYER_ID" />
		</association>

	</resultMap>

	<select id="selectProd" parameterType="string"
		resultMap="prodMap">
		SELECT PROD.*,LPROD.*,BUYER.*
		FROM PROD INNER JOIN LPROD ON
		(PROD_LGU = LPROD_GU)
		INNER JOIN BUYER ON (PROD_BUYER = BUYER_ID)
		WHERE PROD_ID = #{prod_id}
	</select>

	<select id="selectProdList" resultMap="prodMap" parameterType="PagingVO">
		SELECT B.*
		FROM(
			SELECT A.*, ROWNUM RNUM
			FROM(
				SELECT PROD.*,LPROD.*,BUYER.*
				FROM PROD INNER JOIN LPROD ON (PROD_LGU = LPROD_GU)
						  INNER JOIN BUYER ON (PROD_BUYER = BUYER_ID)
			 	ORDER BY PROD_LGU ASC
			) A
		) B
		<![CDATA[
			 WHERE RNUM >= #{startRow} AND RNUM <= #{endRow} 
		 ]]>
	</select>
	
		<select id="selectTotalRecord" resultType="int">
		SELECT COUNT(*)
		FROM PROD
	</select>
	

</mapper>

	